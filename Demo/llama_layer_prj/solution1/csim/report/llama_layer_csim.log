INFO: [SIM 2] *************** CSIM start ***************
INFO: [SIM 4] CSIM will launch CLANG as the compiler.
   Compiling ../../../../tb.cpp in debug mode
   Generating csim.exe
--- Bắt đầu Testbench cho Llama Layer (dựa trên run.cpp) ---
DEBUG: config read: dim=768 hidden_dim=2048 n_layers=12 n_heads=12 n_kv_heads=12 vocab_size=32000 seq_len=1024
Đã nạp config và 109529856 trọng số từ C:/NCKH/LLama2_110M-Inference_Architecture_on_FPGA/Demo/stories110M.bin

--- 20 phần tử đầu tiên của các khối trọng số ---
token_embedding_table: -0.0224137 -0.0145511 0.00128661 -0.0178788 -0.0402432 0.0219014 0.0472692 0.0111523 0.0294048 0.0156689 -0.000182251 0.0503941 0.0269191 0.0433961 -0.0339103 0.0308827 0.0214133 -0.0166515 0.024012 -0.0675581 
rms_att_weight[layer 0]: 0.128821 0.115769 0.111907 0.131507 0.122284 0.139558 0.113547 0.147413 0.130267 0.10622 0.128081 0.113858 0.122429 0.116557 0.144837 0.114131 0.134115 0.150637 0.110135 0.672292 
rms_att_weight[layer 11]: 1.19048 1.21805 1.15113 1.27838 1.20153 1.24998 1.19086 1.23516 1.18133 1.17857 1.30769 1.12841 1.21096 1.24173 1.26724 1.20009 1.21207 1.19079 1.28655 0.672247 
wq[layer 0]: 0.0356931 0.00303994 -0.0696875 0.0044753 -0.00824255 -0.0159624 -0.0196693 0.00163062 -0.0426718 -0.0239346 0.0704324 -0.0103739 -0.0215091 0.0393774 0.0670594 -0.0869166 -0.0198831 -0.0641189 -0.0219682 0.072246 
wk[layer 0]: -0.0211109 -0.00869436 0.0445335 -0.00727346 0.00742399 0.048986 0.0576494 0.00702634 0.0390657 -0.045086 0.0195053 -0.00206642 1.94351e-05 0.0371236 -0.0694777 -0.028845 0.0460222 -0.0106428 0.0319475 -0.0235805 
wv[layer 0]: -0.000324137 0.00125336 0.0748279 -0.0150818 -0.00988501 -0.0212693 0.0123548 0.030465 0.0332843 0.00674863 -0.00534009 0.0196892 -0.039067 0.0124122 -0.0313378 0.0577935 0.0255266 0.00330311 -0.0173033 -0.000374218 
wo[layer 0]: 0.0366974 -0.0531639 -0.00233748 0.07035 -0.013546 0.0187326 0.000503897 0.0134871 0.021402 -0.0140861 -0.047267 -0.0393356 -0.0383328 -0.0311395 0.0423766 -0.0252 -0.0258806 0.0372701 0.0392705 0.0308817 
wq[layer 11]: -0.0232629 0.0180702 -0.0216138 0.0314252 -0.0134119 0.011764 0.0198701 0.0264117 0.00960581 -0.0193478 -0.0196759 -0.0332037 -0.0180202 0.00441692 0.00657043 0.00364253 -0.00867013 -0.00175932 0.0265022 0.0681012 
wk[layer 11]: 0.0227882 -0.0208079 -0.0316373 -0.0158468 -0.00398646 0.0367836 0.0209063 0.038062 -0.00750317 -0.0237373 0.00321122 0.0381774 0.016935 -0.0187665 -0.0302792 0.034933 0.00937419 -0.0207657 0.0375423 0.0162593 
wv[layer 11]: -0.0398387 0.00807108 -0.0106036 0.0155557 -0.0313783 -0.0492326 0.0348663 -0.0189372 0.0199041 -0.026631 0.0155803 -0.0379732 -0.0334889 0.00644066 -0.00494676 -0.0510597 0.0205915 0.00635586 -0.0253147 0.0279828 
wo[layer 11]: -0.0269081 -0.0158158 -0.0146674 0.00174177 0.0254632 -0.0634601 0.0116321 0.0275986 -0.0338752 0.0292353 -0.0286409 0.0148684 0.02152 -0.0190582 -0.0259709 -0.00572775 -0.00639144 0.0252609 -0.0238035 0.0192088 
rms_ffn_weight[layer 0]: 0.424805 0.441208 0.43294 0.424511 0.368091 0.374236 0.403975 0.426325 0.416315 0.402175 0.418473 0.42489 0.432342 0.397847 0.432209 0.418922 0.419072 0.418864 0.421679 0.0657692 
rms_ffn_weight[layer 11]: 1.13013 1.07675 1.06517 1.13032 1.11568 1.11063 1.10432 1.06453 1.11915 1.07815 1.12702 1.05503 1.11595 1.09209 1.13743 1.08495 1.13327 1.10614 1.0953 1.05087 
w1[layer 0]: 0.00216184 -0.0212844 -0.0397819 -0.0289602 -0.00594303 -0.0407787 -0.0124105 -0.00251742 0.012819 -0.0226389 0.00338979 -0.00296496 0.00323948 -0.00101027 0.000642927 -0.00598732 0.0358745 0.0292852 0.0122512 0.0273571 
w2[layer 0]: -0.0522058 -0.034372 -0.0100975 -0.00484145 0.0205462 0.0024856 -0.00224314 0.0464335 0.023337 -0.0359599 0.00928246 -0.00527738 -0.00531806 0.00925106 -0.000310121 0.0436939 0.0188677 -0.0709157 -0.0583083 -0.0101828 
w3[layer 0]: -0.0298947 0.0255094 0.0354433 0.00754613 -0.0232288 0.00794773 -0.0021837 0.0372634 0.0138628 0.011496 -0.0247071 0.00639186 -0.0182662 0.0210444 -0.0183181 -0.00811568 -0.00355129 -0.0206704 -0.0428165 -0.0410331 
w1[layer 11]: 0.0354141 -0.0116983 0.0296525 -0.00972544 -0.058111 0.006976 0.0159353 0.0686688 -0.0354044 -0.00567623 0.010254 0.0510487 0.00561672 -0.00812314 -0.0355155 -0.0429332 -0.0117269 -0.0455241 0.0296053 -0.0117453 
w2[layer 11]: -0.00612807 0.0341647 0.0158737 0.000103739 0.0369527 -0.00978974 -0.0365189 0.0180876 -0.0269131 -0.0273059 -0.0505403 0.000227428 -0.0171095 -0.0403434 -0.0476966 0.00845248 -0.0230832 0.0379696 -0.0208445 -0.0126141 
w3[layer 11]: 0.0259466 -0.0429828 9.17628e-05 -0.00233406 -0.00525321 0.0029974 -0.00451295 -0.0296892 0.0282633 -0.0182885 0.0306401 0.00471917 -0.0412584 0.0335354 0.00823673 0.0591205 0.02267 -0.0243557 -0.0007599 -0.0346442 
rms_final_weight: 3.18261 3.28215 3.05725 3.17514 2.97255 2.85815 3.16689 3.19182 3.1992 3.06711 3.26018 3.29082 3.92144 3.23733 3.52562 3.11766 3.24463 3.13113 3.10441 9.55025 
Thực thi llama_layer...
Thực thi hoàn tất.
10 logits đầu tiên:
  logits[0] = 0.00330278
  logits[1] = -0.00630607
  logits[2] = 0.0194598
  logits[3] = 0.0201487
  logits[4] = 0.0226777
  logits[5] = 0.00839904
  logits[6] = -0.0165651
  logits[7] = 0.00142725
  logits[8] = -0.0286713
  logits[9] = 0.0043771
10 logits cuối cùng:
  logits[31990] = 0
  logits[31991] = 0
  logits[31992] = 0
  logits[31993] = 0
  logits[31994] = 0
  logits[31995] = 0
  logits[31996] = 0
  logits[31997] = 0
  logits[31998] = 0
  logits[31999] = 0
--- Testbench hoàn tất! ---
INFO [HLS SIM]: The maximum depth reached by any hls::stream() instance in the design is 1572864
INFO: [SIM 1] CSim done with 0 errors.
INFO: [SIM 3] *************** CSIM finish ***************
